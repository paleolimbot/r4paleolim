<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Paleolimnology</title>
  <meta name="description" content="A set of R tutorials for paleolimnology.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R for Paleolimnology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A set of R tutorials for paleolimnology." />
  <meta name="github-repo" content="paleolimbot/r4paleolim" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Paleolimnology" />
  
  <meta name="twitter:description" content="A set of R tutorials for paleolimnology." />
  

<meta name="author" content="Brent Thorne and Dewey Dunnington">


<meta name="date" content="2018-05-16">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="work-with-tables.html">
<link rel="next" href="prepare-load.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Paleolimnology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>0.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>0.1.1</b> Installing R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#other-places-to-learn-rrstudiotidyverse"><i class="fa fa-check"></i><b>0.2</b> Other places to learn R/RStudio/tidyverse</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i><b>0.3</b> Colophon</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>1</b> Basic R</a><ul>
<li class="chapter" data-level="1.1" data-path="basic-r.html"><a href="basic-r.html#prerequisites-1"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="basic-r.html"><a href="basic-r.html#expressions-and-variables"><i class="fa fa-check"></i><b>1.2</b> Expressions and Variables</a></li>
<li class="chapter" data-level="1.3" data-path="basic-r.html"><a href="basic-r.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a></li>
<li class="chapter" data-level="1.4" data-path="basic-r.html"><a href="basic-r.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a></li>
<li class="chapter" data-level="1.5" data-path="basic-r.html"><a href="basic-r.html#indexing"><i class="fa fa-check"></i><b>1.5</b> Indexing</a></li>
<li class="chapter" data-level="1.6" data-path="basic-r.html"><a href="basic-r.html#missing-values"><i class="fa fa-check"></i><b>1.6</b> Missing Values</a></li>
<li class="chapter" data-level="1.7" data-path="basic-r.html"><a href="basic-r.html#data-frames"><i class="fa fa-check"></i><b>1.7</b> Data Frames</a></li>
<li class="chapter" data-level="1.8" data-path="basic-r.html"><a href="basic-r.html#loading-packages"><i class="fa fa-check"></i><b>1.8</b> Loading Packages</a></li>
<li class="chapter" data-level="1.9" data-path="basic-r.html"><a href="basic-r.html#using-the-script-editor"><i class="fa fa-check"></i><b>1.9</b> Using the Script Editor</a></li>
<li class="chapter" data-level="1.10" data-path="basic-r.html"><a href="basic-r.html#the-environment"><i class="fa fa-check"></i><b>1.10</b> The Environment</a></li>
<li class="chapter" data-level="1.11" data-path="basic-r.html"><a href="basic-r.html#excercises"><i class="fa fa-check"></i><b>1.11</b> Excercises</a></li>
<li class="chapter" data-level="1.12" data-path="basic-r.html"><a href="basic-r.html#summary"><i class="fa fa-check"></i><b>1.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="work-with-tables.html"><a href="work-with-tables.html"><i class="fa fa-check"></i><b>2</b> Working with Tables using the Tidyverse</a><ul>
<li class="chapter" data-level="2.1" data-path="work-with-tables.html"><a href="work-with-tables.html#prerequisites-2"><i class="fa fa-check"></i><b>2.1</b> Prerequisites</a></li>
<li class="chapter" data-level="2.2" data-path="work-with-tables.html"><a href="work-with-tables.html#viewing-a-data-frame"><i class="fa fa-check"></i><b>2.2</b> Viewing a Data Frame</a></li>
<li class="chapter" data-level="2.3" data-path="work-with-tables.html"><a href="work-with-tables.html#selecting-columns"><i class="fa fa-check"></i><b>2.3</b> Selecting Columns</a><ul>
<li class="chapter" data-level="2.3.1" data-path="work-with-tables.html"><a href="work-with-tables.html#excercises-1"><i class="fa fa-check"></i><b>2.3.1</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="work-with-tables.html"><a href="work-with-tables.html#chap2_filter"><i class="fa fa-check"></i><b>2.4</b> Filtering Rows</a><ul>
<li class="chapter" data-level="2.4.1" data-path="work-with-tables.html"><a href="work-with-tables.html#exercises"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="work-with-tables.html"><a href="work-with-tables.html#selecting-and-filtering"><i class="fa fa-check"></i><b>2.5</b> Selecting and Filtering</a><ul>
<li class="chapter" data-level="2.5.1" data-path="work-with-tables.html"><a href="work-with-tables.html#exercises-1"><i class="fa fa-check"></i><b>2.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="work-with-tables.html"><a href="work-with-tables.html#the-pipe"><i class="fa fa-check"></i><b>2.6</b> The Pipe (%&gt;%)</a><ul>
<li class="chapter" data-level="2.6.1" data-path="work-with-tables.html"><a href="work-with-tables.html#exercises-2"><i class="fa fa-check"></i><b>2.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="work-with-tables.html"><a href="work-with-tables.html#arranging-sorting-a-data-frame"><i class="fa fa-check"></i><b>2.7</b> Arranging (sorting) A Data Frame</a></li>
<li class="chapter" data-level="2.8" data-path="work-with-tables.html"><a href="work-with-tables.html#distinct-values"><i class="fa fa-check"></i><b>2.8</b> Distinct Values</a></li>
<li class="chapter" data-level="2.9" data-path="work-with-tables.html"><a href="work-with-tables.html#calculating-columns-using-mutate"><i class="fa fa-check"></i><b>2.9</b> Calculating columns using <code>mutate()</code></a></li>
<li class="chapter" data-level="2.10" data-path="work-with-tables.html"><a href="work-with-tables.html#summarising-a-data-frame"><i class="fa fa-check"></i><b>2.10</b> Summarising A Data Frame</a><ul>
<li class="chapter" data-level="2.10.1" data-path="work-with-tables.html"><a href="work-with-tables.html#excercises-2"><i class="fa fa-check"></i><b>2.10.1</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="work-with-tables.html"><a href="work-with-tables.html#extracting-columns"><i class="fa fa-check"></i><b>2.11</b> Extracting Columns</a></li>
<li class="chapter" data-level="2.12" data-path="work-with-tables.html"><a href="work-with-tables.html#base-r-subsetting-vs.select-and-filter"><i class="fa fa-check"></i><b>2.12</b> Base R Subsetting vs. select() and filter()</a></li>
<li class="chapter" data-level="2.13" data-path="work-with-tables.html"><a href="work-with-tables.html#summary-1"><i class="fa fa-check"></i><b>2.13</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html"><i class="fa fa-check"></i><b>3</b> Creating Visualizations using ggplot</a><ul>
<li class="chapter" data-level="3.1" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#prerequisites-3"><i class="fa fa-check"></i><b>3.1</b> Prerequisites</a></li>
<li class="chapter" data-level="3.2" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#using-ggplot"><i class="fa fa-check"></i><b>3.2</b> Using ggplot</a></li>
<li class="chapter" data-level="3.3" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#aesthetics"><i class="fa fa-check"></i><b>3.3</b> Aesthetics</a></li>
<li class="chapter" data-level="3.4" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#geometries"><i class="fa fa-check"></i><b>3.4</b> Geometries</a></li>
<li class="chapter" data-level="3.5" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#facets"><i class="fa fa-check"></i><b>3.5</b> Facets</a></li>
<li class="chapter" data-level="3.6" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#make-it-look-pretty"><i class="fa fa-check"></i><b>3.6</b> Make it look pretty</a><ul>
<li class="chapter" data-level="3.6.1" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#labels"><i class="fa fa-check"></i><b>3.6.1</b> Labels</a></li>
<li class="chapter" data-level="3.6.2" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#themes"><i class="fa fa-check"></i><b>3.6.2</b> Themes</a></li>
<li class="chapter" data-level="3.6.3" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#scales"><i class="fa fa-check"></i><b>3.6.3</b> Scales</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#summary-2"><i class="fa fa-check"></i><b>3.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prepare-load.html"><a href="prepare-load.html"><i class="fa fa-check"></i><b>4</b> Preparing and Loading Data</a><ul>
<li class="chapter" data-level="4.1" data-path="prepare-load.html"><a href="prepare-load.html#prerequisites-4"><i class="fa fa-check"></i><b>4.1</b> Prerequisites</a></li>
<li class="chapter" data-level="4.2" data-path="prepare-load.html"><a href="prepare-load.html#loading-data"><i class="fa fa-check"></i><b>4.2</b> Loading data</a></li>
<li class="chapter" data-level="4.3" data-path="prepare-load.html"><a href="prepare-load.html#transforming-data"><i class="fa fa-check"></i><b>4.3</b> Transforming data</a></li>
<li class="chapter" data-level="4.4" data-path="prepare-load.html"><a href="prepare-load.html#exporing-data"><i class="fa fa-check"></i><b>4.4</b> Exporing data</a></li>
<li class="chapter" data-level="4.5" data-path="prepare-load.html"><a href="prepare-load.html#summary-3"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="strat-diagrams.html"><a href="strat-diagrams.html"><i class="fa fa-check"></i><b>5</b> Creating Stratigraphic Diagrams</a><ul>
<li class="chapter" data-level="5.1" data-path="strat-diagrams.html"><a href="strat-diagrams.html#prerequisites-5"><i class="fa fa-check"></i><b>5.1</b> Prerequisites</a></li>
<li class="chapter" data-level="5.2" data-path="strat-diagrams.html"><a href="strat-diagrams.html#workflow"><i class="fa fa-check"></i><b>5.2</b> Workflow</a></li>
<li class="chapter" data-level="5.3" data-path="strat-diagrams.html"><a href="strat-diagrams.html#general-stratigraphic-diagrams"><i class="fa fa-check"></i><b>5.3</b> General stratigraphic diagrams</a><ul>
<li class="chapter" data-level="5.3.1" data-path="strat-diagrams.html"><a href="strat-diagrams.html#data-preparation"><i class="fa fa-check"></i><b>5.3.1</b> Data preparation</a></li>
<li class="chapter" data-level="5.3.2" data-path="strat-diagrams.html"><a href="strat-diagrams.html#plotting-a-single-core"><i class="fa fa-check"></i><b>5.3.2</b> Plotting a single core</a></li>
<li class="chapter" data-level="5.3.3" data-path="strat-diagrams.html"><a href="strat-diagrams.html#changing-the-colours"><i class="fa fa-check"></i><b>5.3.3</b> Changing the colours</a></li>
<li class="chapter" data-level="5.3.4" data-path="strat-diagrams.html"><a href="strat-diagrams.html#facet-configuration"><i class="fa fa-check"></i><b>5.3.4</b> Facet configuration</a></li>
<li class="chapter" data-level="5.3.5" data-path="strat-diagrams.html"><a href="strat-diagrams.html#reordering-facets"><i class="fa fa-check"></i><b>5.3.5</b> Reordering facets</a></li>
<li class="chapter" data-level="5.3.6" data-path="strat-diagrams.html"><a href="strat-diagrams.html#relabeling-facets"><i class="fa fa-check"></i><b>5.3.6</b> Relabeling facets</a></li>
<li class="chapter" data-level="5.3.7" data-path="strat-diagrams.html"><a href="strat-diagrams.html#adding-annotations"><i class="fa fa-check"></i><b>5.3.7</b> Adding annotations</a></li>
<li class="chapter" data-level="5.3.8" data-path="strat-diagrams.html"><a href="strat-diagrams.html#a-second-axis-for-ages"><i class="fa fa-check"></i><b>5.3.8</b> A second axis for ages</a></li>
<li class="chapter" data-level="5.3.9" data-path="strat-diagrams.html"><a href="strat-diagrams.html#multiple-cores"><i class="fa fa-check"></i><b>5.3.9</b> Multiple cores</a></li>
<li class="chapter" data-level="5.3.10" data-path="strat-diagrams.html"><a href="strat-diagrams.html#overlapping-x-axis-labels"><i class="fa fa-check"></i><b>5.3.10</b> Overlapping x-axis labels</a></li>
<li class="chapter" data-level="5.3.11" data-path="strat-diagrams.html"><a href="strat-diagrams.html#saving-a-plot"><i class="fa fa-check"></i><b>5.3.11</b> Saving a plot</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="strat-diagrams.html"><a href="strat-diagrams.html#exercises-3"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
<li class="chapter" data-level="5.5" data-path="strat-diagrams.html"><a href="strat-diagrams.html#species-composition-diagrams"><i class="fa fa-check"></i><b>5.5</b> Species composition diagrams</a><ul>
<li class="chapter" data-level="5.5.1" data-path="strat-diagrams.html"><a href="strat-diagrams.html#using-ggplot2"><i class="fa fa-check"></i><b>5.5.1</b> Using ggplot2</a></li>
<li class="chapter" data-level="5.5.2" data-path="strat-diagrams.html"><a href="strat-diagrams.html#strat-species-analogue"><i class="fa fa-check"></i><b>5.5.2</b> Using analogue::Stratiplot</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="strat-diagrams.html"><a href="strat-diagrams.html#exercises-4"><i class="fa fa-check"></i><b>5.6</b> Exercises</a></li>
<li class="chapter" data-level="5.7" data-path="strat-diagrams.html"><a href="strat-diagrams.html#summary-4"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Paleolimnology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="creating-visualizations-using-ggplot" class="section level1">
<h1><span class="header-section-number">Tutorial 3</span> Creating Visualizations using ggplot</h1>
<p>This tutorial will introduce you to using <code>ggplot2</code> in order to visualize your data. R has many options for creating graphs and figures but, <code>ggplot2</code> is versitile, firendly to learn, and quite elegant. Using <code>ggplot2</code> you will be able to quickly learn the basics of it’s functionallity and apply those skills to more advanced figures as explained in <a href="strat-diagrams.html#strat-diagrams">Chapter 5</a>.</p>
<p>For more information, see the <a href="http://r4ds.had.co.nz/data-visualisation.html">data visualization</a> chapter in <a href="http://r4ds.had.co.nz/">R for Data Science</a>.</p>
<div id="prerequisites-3" class="section level2">
<h2><span class="header-section-number">3.1</span> Prerequisites</h2>
<p>The prerequisite for this tutorial is the <code>tidyverse</code> package. If this package isn’t installed, you’ll have to install it using <code>install.packages()</code>.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</a></code></pre></div>
<p>Load the packages when you’re done! If there are errors, you may have not installed the above packages correctly!</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>Finally, you will need to load the example data. For now, copy and paste the following code to load the <a href="data/halifax_geochem.csv">Halifax geochemistry dataset</a> (we will learn how to read various types of files into R in the <a href="prepare-load.html#prepare-load">preparing and loading data</a> tutorial).</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">halifax_geochem &lt;-<span class="st"> </span><span class="kw">read_csv</span>(</a>
<a class="sourceLine" id="cb119-2" data-line-number="2">  <span class="st">&quot;http://paleolimbot.github.io/r4paleolim/data/halifax_geochem.csv&quot;</span>,</a>
<a class="sourceLine" id="cb119-3" data-line-number="3">  <span class="dt">col_types =</span> <span class="kw">cols</span>(<span class="dt">.default =</span> <span class="kw">col_guess</span>())</a>
<a class="sourceLine" id="cb119-4" data-line-number="4">)</a></code></pre></div>
<p>It’s worth mentioning a little bit about what this data frame contains, since we’ll be working with it for the rest of this tutorial. The data contains several bulk geochemical parameters from a recent study of Halifax drinking water reservoirs <span class="citation">(Dunnington et al. <a href="#ref-dunnington18">2018</a>)</span>, including Pockwock Lake, Lake Major, Bennery Lake, Lake Fletcher, Lake Lemont, First Chain Lake, First Lake, and Second Lake. (Later, we will take a look at the <a href="data/halifax_geochem_cores.xlsx">core locations</a> as well as the geochemical data).</p>
</div>
<div id="using-ggplot" class="section level2">
<h2><span class="header-section-number">3.2</span> Using ggplot</h2>
<p>The Grammar of Graphics (the “gg” in “ggplot”) is a way of describing a graphic that is derived from data, which in R is done using the <code>ggplot()</code> function and its many friends. Unlike other plotting functions, <code>ggplot()</code> builds graphics from the data up (rather than starting with a template of a graphic and working backward). Before we can use <code>ggplot</code> functionality we need to use the skills learned in <a href="work-with-tables.html#work-with-tables">Chapter 2</a> where we filtered our data. See if you can use <code>filter()</code> on the <code>halifax_geochem</code> data to create the <code>pockwock_data</code> and <code>pockwock_major_data</code> variable (HINT: check out the <a href="work-with-tables.html#chap2_filter">Filtering Rows</a> secontion in <a href="#work-with%20tabl">Chapter 2</a>).</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">pockwock_data &lt;-<span class="st"> </span><span class="kw">filter</span>(halifax_geochem, core_id <span class="op">==</span><span class="st"> &quot;POC15-2&quot;</span>)</a>
<a class="sourceLine" id="cb120-2" data-line-number="2"></a>
<a class="sourceLine" id="cb120-3" data-line-number="3">pockwock_major_data &lt;-<span class="st"> </span><span class="kw">filter</span>(halifax_geochem, core_id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;POC15-2&quot;</span>, <span class="st">&quot;MAJ15-1&quot;</span>))</a></code></pre></div>
<p>Now we can start with the <code>ggplot</code> example using the <code>pockwock_major_data</code>:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> pockwock_major_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent)) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<ul>
<li>What the structure of the <code>ggplot()</code> call is</li>
</ul>
<p>Steps for plotting:</p>
<ul>
<li>Envision how you want your plot to look (draw it on paper if you have to!)</li>
<li>Setup the data (<code>select()</code>, <code>filter()</code>)</li>
<li>Setup your mapping (<code>aes()</code>)</li>
<li>Choose your geoms (<code>geom_*()</code>)</li>
<li>Make it look pretty</li>
</ul>
</div>
<div id="aesthetics" class="section level2">
<h2><span class="header-section-number">3.3</span> Aesthetics</h2>
<p>Categorical/Grouping Variables get mapped to X, Y, Colour, Shape, Linetype. Continuous Variables get mapped to X, Y, Colour, Size. For example, we can choose to colour the previous figure in order to visually see the difference between core samples by simply adding a <code>colour = core_id</code> argument to the aesthetic:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> pockwock_major_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent, <span class="dt">colour =</span> core_id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb123-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p>Notice how there is a legend automatically generated for us? We will look into changeing the labelling of that later in this tutorial! We can also choose to categorize our data with shapes other than the points seen previously, since not all figures may be welcome if they have colour!</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> pockwock_major_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent, <span class="dt">shape =</span> core_id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb125-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>Now we can try to provide some information on depth by making each symbols size relative to its depth value. For this example I only want to use the <code>pockwock_data</code> we previously created in <a href="work-with-tables.html#work-with-tables">Chapter 2</a>:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> pockwock_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent, <span class="dt">size =</span> depth_cm)) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
</div>
<div id="geometries" class="section level2">
<h2><span class="header-section-number">3.4</span> Geometries</h2>
<p>We can easily change the type of geometry being used in the <code>ggplot</code> we have been working on. Here is an example of the same figure as above only with <code>geom_line</code> instead of <code>geom_point</code>:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> pockwock_major_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent, <span class="dt">colour =</span> core_id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_line</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_path).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>Or we could choose multiple geometries!</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> pockwock_major_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent, <span class="dt">colour =</span> core_id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb131-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
</div>
<div id="facets" class="section level2">
<h2><span class="header-section-number">3.5</span> Facets</h2>
<p>An alternative to altering aesthetics of a plot to provide the end-user with visual seperation is to split your plot into facets, subplots that each display one subset of the data. We can do this simply by using the <code>facet_wrap()</code> argument. For this example we can use the origional <code>halifax_geochem</code> table and create one facet for each core!</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> halifax_geochem, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent)) <span class="op">+</span></a>
<a class="sourceLine" id="cb134-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb134-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb134-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>core_id)</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>This is great, however we may wnat to change the layout of these facet plots. We can do this easily by specifying the number of rows <code>nrow=</code> or the number of columns <code>ncol=</code> within <code>facet_wrap</code>.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> halifax_geochem, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent)) <span class="op">+</span></a>
<a class="sourceLine" id="cb137-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb137-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb137-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>core_id, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
</div>
<div id="make-it-look-pretty" class="section level2">
<h2><span class="header-section-number">3.6</span> Make it look pretty</h2>
<div id="labels" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Labels</h3>
<p>Rather than using the column headings from your data table which often are (and should be) rittled with short form versions of what it represents as well as underscores for any division of words. The <code>labs()</code> function cab be used to give your figure a more desirable presentation to the end users. Here I have changed the x and y values from <code>K_percent</code> and <code>Ti_percent</code> to <code>K (%)</code> and <code>Ti (%)</code> respectively. While we’re at it, lets change the legend title text just for fun!</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> pockwock_major_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent, <span class="dt">colour =</span> core_id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb140-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb140-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> pockwock_major_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> K_percent, <span class="dt">y =</span> Ti_percent, <span class="dt">colour =</span> core_id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb143-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb143-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb143-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;K (%)&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Ti (%)&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Core ID&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_path).

## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="r4paleolim_files/figure-html/unnamed-chunk-82-2.png" width="672" /></p>
</div>
<div id="themes" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Themes</h3>
</div>
<div id="scales" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Scales</h3>
<p>We can also change the scales of our axis using <code>scale_*_discrete()</code> or <code>scale_*_continuous()</code>. Common discrete scale parameters: name, breaks, labels, na.value, limits and guide.</p>
</div>
</div>
<div id="summary-2" class="section level2">
<h2><span class="header-section-number">3.7</span> Summary</h2>
<p>Tutorial summary</p>
<p>For more information, see the <a href="http://r4ds.had.co.nz/data-visualisation.html">data visualization</a> chapter in <a href="http://r4ds.had.co.nz/">R for Data Science</a>.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-dunnington18">
<p>Dunnington, Dewey W., I. S. Spooner, Wendy H. Krkošek, Graham A. Gagnon, R. Jack Cornett, Chris E. White, Benjamin Misiuk, and Drake Tymstra. 2018. “Anthropogenic Activity in the Halifax Region, Nova Scotia, Canada, as Recorded by Bulk Geochemistry of Lake Sediments.” <a href="https://doi.org/10.1080/10402381.2018.1461715" class="uri">https://doi.org/10.1080/10402381.2018.1461715</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="work-with-tables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prepare-load.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/paleolimbot/r4paleolim/edit/master/03-ggplot.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
